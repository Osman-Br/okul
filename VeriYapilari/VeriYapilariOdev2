#include <stdio.h>
#include <string.h>
#include <malloc.h>

struct indeksTablosu
{
    int indeks;
    int deger;
    char isim[7];
    struct indeksTablosu* sonraki;
    struct indeksTablosu* onceki;
};
struct isimIndeksTablosu
{
    int indeks;
    int deger;
    char isim[7];
    struct isimIndeksTablosu* sonraki;
    struct isimIndeksTablosu* onceki;
};
struct musteri
{
    char musteriIsmi[7];
    int fatura;
    int indeks;
    struct musteri* sonraki;
    struct musteri* onceki;
};

void musteri_ekle(struct musteri* ilk, char musteriIsmi[7], int fatura, int* listeBoyutu, struct indeksTablosu* fatura_T, struct isimIndeksTablosu* isim_T); //verilen degerleri musteri listesine ekler
void isme_gore_ekle(struct musteri* ilk, char musteriIsmi[7], int fatura, int* listeBoyutu, struct indeksTablosu* fatura_T, struct isimIndeksTablosu* isim_T);  //verilen degerleri isimler alafabetik sirada olacak sekilde musteri listesine ekler
void faturaya_gore_ekle(struct musteri* ilk, char musteriIsmi[7], int fatura, int* listeBoyutu, struct indeksTablosu* fatura_T, struct isimIndeksTablosu* isim_T); //verilen degerleri faturalar buyukten kucuge olacak sekilde musteri listesine ekler
void harfe_gore_yazdir(char harf, struct isimIndeksTablosu* isim_T);              //musteri ismi harf degiskeniyle baslayan elemanlari yazdirir
void faturaya_gore_yazdir(int fatura, struct  indeksTablosu* fatura_T);             //musteri faturasi, fonksiyona verilen fatura degiskeninden buyuk olan elemanlari yazdirir


void fatura_T_sirala(struct indeksTablosu* fatura_T);                   //fatura_T listesini faturalar buyukten kucuge olacak sekilde siralar
void isim_T_sirala(struct isimIndeksTablosu* fatura_T);                  //isim_T listesini isimler alfabetik sirada olacak sekilde siralar
void degerYerDegistir(struct indeksTablosu* a,struct indeksTablosu* b);             //verilen liste elemanlarının deger degiskenlerini yer değiştirir
void isimYerDegistir(struct isimIndeksTablosu* a,struct isimIndeksTablosu* b);        //verilen liste elemanlarının isim degiskenlerini yer değiştirir

int main() {
    int musteri_Liste_Boyutu = 0;

    struct isimIndeksTablosu* isim_T;
    isim_T = (struct isimIndeksTablosu*)malloc(sizeof(struct isimIndeksTablosu));       //isim indeks tablosunun başını belirler
    isim_T->sonraki = NULL;
    isim_T->onceki = NULL;

    struct indeksTablosu* fatura_T;
    fatura_T = (struct indeksTablosu*)malloc(sizeof(struct indeksTablosu));            //fatura indeks tablosunun başını belirler
    fatura_T->sonraki = NULL;
    fatura_T->onceki = NULL;

    struct musteri* ilk;
    ilk = (struct musteri*)malloc(sizeof(struct musteri));                        //musteri bilgilerinin bulundugu listenin basını belirler
    ilk->sonraki = NULL;


    musteri_ekle(ilk, "Ahmet", 100, &musteri_Liste_Boyutu, fatura_T, isim_T);      //verilen musteri bilgileri listeye ekleniyor
    musteri_ekle(ilk, "Bilal", 1000, &musteri_Liste_Boyutu, fatura_T, isim_T);
    musteri_ekle(ilk, "Cemal", 600, &musteri_Liste_Boyutu, fatura_T, isim_T);
    musteri_ekle(ilk, "Adem", 600, &musteri_Liste_Boyutu, fatura_T, isim_T);
    musteri_ekle(ilk, "Yasin", 350, &musteri_Liste_Boyutu, fatura_T, isim_T);
    musteri_ekle(ilk, "Esin", 270, &musteri_Liste_Boyutu, fatura_T, isim_T);
    musteri_ekle(ilk, "Emel", 410, &musteri_Liste_Boyutu, fatura_T, isim_T);
    musteri_ekle(ilk, "Mustafa", 750, &musteri_Liste_Boyutu, fatura_T, isim_T);
    musteri_ekle(ilk, "Ayten", 600, &musteri_Liste_Boyutu, fatura_T, isim_T);
    musteri_ekle(ilk, "Ceylan", 1000, &musteri_Liste_Boyutu, fatura_T, isim_T);
    musteri_ekle(ilk, "Nesrin", 900, &musteri_Liste_Boyutu, fatura_T, isim_T);
    musteri_ekle(ilk, "Bekir", 850, &musteri_Liste_Boyutu, fatura_T, isim_T);
    musteri_ekle(ilk, "Emin", 790, &musteri_Liste_Boyutu, fatura_T, isim_T);
    musteri_ekle(ilk, "Hakan", 610, &musteri_Liste_Boyutu, fatura_T, isim_T);
    musteri_ekle(ilk, "Hatice", 550, &musteri_Liste_Boyutu, fatura_T, isim_T);
    fatura_T_sirala(fatura_T);                                                              //eklenen elemanlar siralaniyor
    isim_T_sirala(isim_T);

    isme_gore_ekle(ilk,"Ali",700,&musteri_Liste_Boyutu,fatura_T,isim_T);
    faturaya_gore_ekle(ilk,"Ali",950,&musteri_Liste_Boyutu,fatura_T,isim_T);
    struct musteri *a = ilk->sonraki;
    while(a != NULL)
    {
        printf("isim:%s,fatura:%d,indeks:%d\n",a->musteriIsmi,a->fatura,a->indeks);
        a = a->sonraki;
    }
    harfe_gore_yazdir('A',isim_T);
    faturaya_gore_yazdir(900,fatura_T);
    printf("%d",strcmp("a","ahmet"));
    return 0;
}

void musteri_ekle(struct musteri* ilk, char musteriIsmi[7], int fatura, int* listeBoyutu, struct indeksTablosu* fatura_T, struct isimIndeksTablosu* isim_T) //verilen fatura ve isim degiskenlerini listelere ekler
{
    struct musteri* pointer = (struct musteri*)malloc(sizeof(struct musteri));
    struct indeksTablosu* pointer2 = (struct indeksTablosu*)malloc(sizeof(struct indeksTablosu));
    struct isimIndeksTablosu* pointer3 = (struct isimIndeksTablosu*)malloc(sizeof(struct isimIndeksTablosu));

    pointer->fatura = fatura;
    pointer2->deger = fatura;
    pointer3->deger = fatura;

    strcpy(pointer->musteriIsmi,musteriIsmi);
    strcpy(pointer2->isim,musteriIsmi);
    strcpy(pointer3->isim,musteriIsmi);

    pointer->sonraki = NULL;
    pointer2->sonraki = NULL;
    pointer3->sonraki = NULL;

    pointer->indeks = *listeBoyutu;
    pointer2->indeks = *listeBoyutu;
    pointer3->indeks = *listeBoyutu;

    struct musteri *a = ilk;
    struct indeksTablosu* c = fatura_T;
    struct isimIndeksTablosu* d = isim_T;
    //if(a->sonraki == NULL){
        //a->fatura = fatura;
        //strcpy(a->musteriIsmi,musteriIsmi);
        //a->sonraki = NULL;
        //a->indeks = *listeBoyutu;
   // }else {
        while (a->sonraki != NULL) {
            struct musteri *once = a;
            struct indeksTablosu *once2 = c;
            struct isimIndeksTablosu *once3 = d;

            a = a->sonraki;
            a->onceki = once;

            d = d->sonraki;
            d->onceki = once3;

            c = c->sonraki;
            c->onceki = once2;
        }
   // }
        a->sonraki = pointer;
        d->sonraki = pointer3;
        c->sonraki = pointer2;
        *listeBoyutu += 1;
}
void isme_gore_ekle(struct musteri* ilk, char musteriIsmi[7], int fatura, int* listeBoyutu, struct indeksTablosu* fatura_T, struct isimIndeksTablosu* isim_T){
    struct isimIndeksTablosu* isimP = isim_T->sonraki;
    struct isimIndeksTablosu* isimP_once = isim_T;
    while(isimP->sonraki != NULL){
        if(strcmp(musteriIsmi,isimP->isim)>0){
            break;
        }else{
            isimP = isimP->sonraki;
            isimP_once = isimP_once->sonraki;
        }
    }
    struct isimIndeksTablosu* yeni = (struct isimIndeksTablosu*)malloc(sizeof(struct isimIndeksTablosu));
    strcpy(yeni->isim,musteriIsmi);
    yeni->indeks = *listeBoyutu;
    yeni->deger = fatura;
    yeni->sonraki = isimP;
    isimP_once->sonraki = yeni;
    *listeBoyutu += 1;
}
void faturaya_gore_ekle(struct musteri* ilk, char musteriIsmi[7], int fatura, int* listeBoyutu, struct indeksTablosu* fatura_T, struct isimIndeksTablosu* isim_T){
    struct indeksTablosu* faturaP = fatura_T->sonraki;
    struct indeksTablosu* faturaP_once = fatura_T;
    while(faturaP->sonraki != NULL){
        if(fatura > faturaP->deger){
            break;
        }else{
            faturaP = faturaP->sonraki;
            faturaP_once = faturaP_once->sonraki;
        }
    }
    struct indeksTablosu* yeni = (struct indeksTablosu*)malloc(sizeof(struct indeksTablosu));
    yeni->indeks = *listeBoyutu;
    yeni->deger = fatura;
    strcpy(yeni->isim,musteriIsmi);
    yeni->sonraki = faturaP;
    faturaP_once->sonraki = yeni;
    *listeBoyutu += 1;
}
void harfe_gore_yazdir(char harf, struct isimIndeksTablosu* isim_T){
    struct isimIndeksTablosu* isimP = isim_T->sonraki;
    while(isimP->sonraki != NULL){
        if(isimP->isim[0] != harf)
        {
            break;
        }else{
            isimP = isimP->sonraki;
        }
    }
    struct isimIndeksTablosu* l = isim_T->sonraki;
    while(isimP != l){
        printf("isim %s %d\n",l->isim,l->deger);
        l = l->sonraki;
    }
}
void faturaya_gore_yazdir(int fatura, struct  indeksTablosu* fatura_T){
    struct indeksTablosu* faturaP = fatura_T->sonraki;
    while(faturaP->sonraki != NULL){
        if(fatura > faturaP->deger){
            break;
        }else{
            faturaP = faturaP->sonraki;
        }
    }
    struct indeksTablosu* z = fatura_T->sonraki;
    while(z != faturaP){
        printf("isim %s %d\n",z->isim,z->deger);
        z = z->sonraki;
    }
}

void degerYerDegistir(struct indeksTablosu* a, struct indeksTablosu* b){
    int c = a->deger;
    int d = a->indeks;
    a->deger = b->deger;              //verilen indeks tablosu elemanlarinin degerlerini ve indeksleri yer degistirir
    a->indeks = b->indeks;
    b->deger = c;
    b->indeks = d;
}
void isimYerDegistir(struct isimIndeksTablosu* a, struct isimIndeksTablosu* b){
    char c[7];
    int d = a->indeks;
    int i;
    for(i = 0 ; i < 7 ; i++){             //verilen indekst tablosu elemanlarinin isimlerini ce indekslerini yer degistiri
        c[i] = a->isim[i];
    }
    a->indeks = b->indeks;
    for(i = 0 ; i < 7 ; i++){
        a->isim[i] = b->isim[i];
    }
    b->indeks = d;
    for(i = 0 ; i < 7 ; i++){
        b->isim[i] = c[i];
    }
}

void fatura_T_sirala(struct indeksTablosu* fatura_T){
    struct indeksTablosu* pointer = fatura_T->sonraki;
    struct indeksTablosu* pointerD = fatura_T;

    while(pointerD->sonraki != NULL) {
        pointer = fatura_T->sonraki;
        while (pointer->sonraki != NULL) {
            if (pointer->deger < pointer->sonraki->deger) {
                degerYerDegistir(pointer, pointer->sonraki);
            }
            pointer =  pointer->sonraki;
        }
        pointerD = pointerD->sonraki;
    }
}
void isim_T_sirala(struct isimIndeksTablosu* isim_T){
    struct isimIndeksTablosu* pointer = NULL;
    struct isimIndeksTablosu* pointerD = isim_T->sonraki;

    while(pointerD->sonraki != NULL) {
        pointer = isim_T->sonraki;
        while (pointer->sonraki != NULL) {
            if (strcmp(pointer->isim,(pointer->sonraki)->isim) > 0) {
                isimYerDegistir(pointer, pointer->sonraki);
            }
            pointer =  pointer->sonraki;
        }
        pointerD = pointerD->sonraki;
    }
}
